!function($){$.fn.newsletterValidation=function(){if($.html5ValidationAvailable()!==!1)return this.each(function(){var $this=$(this),$email=$this.find("input[type=email]"),$submit=$this.find("input[type=submit]");$.manageState($email,$submit),$email.on("keyup change",function(){$.manageState($(this),$submit)})})},$.html5ValidationAvailable=function(){return"function"==typeof document.createElement("input").checkValidity},$.isEmail=function(str){return/^[\w.%+\-]+@[\w.\-]+\.[A-Za-z]{2,6}$/.test(str)},$.manageState=function($email,$submit){$submit.prop("disabled",!$.isEmail($email.val()))}}(jQuery),$("#signup").newsletterValidation(),$(document).ready(function(){var emailWrapper=".email-wrapper",addressWrapper=".address-wrapper",contactEmail="#contact_email",contactPostal="#contact_postal",formStepOne=".form-step-1",formStepTwo=".form-step-2",formStepThree=".form-step-3",button=".button",buttonBack=".button-back",radio='input[type="radio"]',formWarningError=".form-warning-error",formNatName="#naturalisation",progressTrack=".progress-track";$(emailWrapper).hide(),$(addressWrapper).hide(),$(formStepTwo).hide(),$(formStepThree).hide(),$(button,".form-step-1,.form-step-2").css("display","block"),$(buttonBack,".form-step-2,.form-step-3").css("display","block"),$(progressTrack).css("display","table"),$(formWarningError).css("color","black"),$(button).on("click",function(){var form=$(formNatName);$.validator.addMethod("exactLength",function(value,element,parameter){return this.optional(element)||value.length===parameter}),form.validate({errorElement:"span",errorClass:"form-error form-hint",highlight:function(element,errorClass,validClass){$(element).closest('input[type="text"]').addClass("form-warning"),$(element).closest('input[type="email"]').addClass("form-warning"),$(element).closest("textarea").addClass("form-warning")},unhighlight:function(element,errorClass,validClass){$(element).closest("input").removeClass("form-warning")},rules:{"certificate-day":{digits:!0,exactLength:2},"certificate-month":{digits:!0,exactLength:2},"certificate-year":{digits:!0,exactLength:4},forename:{required:!0},surname:{required:!0},preferred_contact:{required:!0},email:"required","confirm-email":{equalTo:"#email"},"postal-address":{required:!0},"certificate-forename":{required:!0},"certificate-surname":{required:!0},"certificate-birth-country":{required:!0},contact_email:{required:function(element){return $("#contact-postal:checked").length<=0}},"preferred-contact":{required:function(element){return $("#contact-email:checked").length<=0}}},messages:{"certificate-day":{required:"Day",digits:"Only digits",exactLength:"Two digits"},"certificate-month":{required:"Month",digits:"Only digits",exactLength:"Two digits"},"certificate-year":{required:"Year",digits:"Only digits",exactLength:"Four digits"},forename:{required:"Please enter your first name"},surname:{required:"Please enter your last name"},email:"Please enter your email address","confirm-email":{required:"Please enter your email address",equalTo:"Please enter your email address again"},"postal-address":{required:"Please enter your postal address"},"certificate-forename":{required:"Please enter the certificate holder’s first name"},"certificate-surname":{required:"Please enter the certificate holder’s last name"},"certificate-birth-country":{required:"Please enter the certificate holder’s country of birth"},"preferred-contact":{required:"Please select one option"}}}),form.valid()===!0&&($(formStepOne).is(":visible")?(current_fs=$(formStepOne),next_fs=$(formStepTwo),$(".arrow-steps li:nth-child(2)").addClass("current"),$(button).prop("disabled",!0)):$(formStepTwo).is(":visible")&&(current_fs=$(formStepTwo),next_fs=$(formStepThree),$(".arrow-steps li:nth-child(3)").addClass("current"),$(button).prop("disabled",!1)),next_fs.show(),current_fs.hide())}),$(radio).is(":checked")&&($(formWarningError).css("color","black"),$(button).prop("disabled",!1)),$(radio).change(function(){$(formWarningError).css("color","black"),$(button).prop("disabled",!1)}),$(radio).on("click",function(){$(contactEmail).is(":checked")?($(emailWrapper).show(),$(addressWrapper).hide(),$(formWarningError).css("color","black")):$(contactPostal).is(":checked")&&($(addressWrapper).show(),$(emailWrapper).hide(),$(formWarningError).css("color","black"))}),$(buttonBack,formStepTwo).on("click",function(){$(formStepOne).show(),$(formStepTwo).hide(),$(".arrow-steps li:nth-child(2)").removeClass("current"),$(".arrow-steps li:nth-child(3)").removeClass("current")}),$(buttonBack,formStepThree).on("click",function(){$(formStepTwo).show(),$(formStepThree).hide(),$(".arrow-steps li:nth-child(3)").removeClass("current")})});